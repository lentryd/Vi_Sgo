(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-71367435"],{a55b:function(t,s,i){"use strict";i.r(s);var n=function(){var t=this,s=t.$createElement,i=t._self._c||s;return i("div",{staticClass:"login"},[i("md-steppers",{attrs:{"md-linear":"","md-vertical":t.windowWidth<800,"md-active-step":t.currentStep},on:{"update:mdActiveStep":function(s){t.currentStep=s},"update:md-active-step":function(s){t.currentStep=s}}},[i("md-step",{attrs:{id:"domain","md-label":"Домен","md-done":t.domain.fit,"md-error":!1===t.domain.fit?"Не подходит":null,"md-editable":!1,"md-description":t.domain.loading?"Проверка...":null}},[i("p",[t._v("Ниже нужно указать ссылку на ваш сетевой город.")]),i("i",[t._v("Например: "),i("a",{attrs:{href:"//sgo.rso23.ru"}},[t._v("https://sgo.rso23.ru")]),t._v(" или "),i("a",{attrs:{href:"//212.220.99.65"}},[t._v("http://212.220.99.65")])]),i("md-field",{class:{"md-invalid":!1===t.domain.fit}},[i("label",[t._v("Ссылка")]),i("span",{staticClass:"md-error"},[t._v("Этот сайт не подходит")]),i("span",{staticClass:"md-helper-text"},[t._v(t._s(t.domain.loading?"Проверка сайта...":"Введите ссылку на сайт"))]),i("md-input",{attrs:{disabled:t.disabledInput},model:{value:t.domain.host,callback:function(s){t.$set(t.domain,"host","string"===typeof s?s.trim():s)},expression:"domain.host"}})],1),i("md-button",{staticClass:"md-dense md-raised md-primary",attrs:{disabled:t.disabledInput},on:{click:t.checkHost}},[t._v(t._s(t.domain.loading?"Проверка...":"Продолжить"))])],1),i("md-step",{attrs:{id:"ttslogin","md-label":"Образовательная организация","md-done":t.ttslogin.done,"md-error":t.invalidTTSlogin?"Не все выбрано":null,"md-editable":!0,"md-description":t.ttslogin.loading?"Загрузка формы...":null}},[i("p",{directives:[{name:"show",rawName:"v-show",value:t.ttslogin.selectors.length,expression:"ttslogin.selectors.length"}]},[t._v(" Ниже вам нужно выбрать ваше учебное заведение. ")]),t._l(t.ttslogin.selectors,(function(s,n){return i("md-field",{directives:[{name:"show",rawName:"v-show",value:!t.hiddenSelector(n),expression:"!hiddenSelector(index)"}],key:s.id,class:{"md-invalid":t.ttslogin.showError&&s.options.length&&!t.checkSelector(s)}},[i("label",{attrs:{for:s.id}},[t._v(t._s(t.ttslogin.labels[s.id]))]),i("md-select",{attrs:{disabled:t.disabledInput},on:{"md-selected":function(s){return t.loadItems(n)}},model:{value:s.value,callback:function(i){t.$set(s,"value",i)},expression:"selector.value"}},t._l(s.options,(function(s){return i("md-option",{key:s.id,attrs:{value:s.id}},[t._v(t._s(s.name))])})),1),i("span",{staticClass:"md-error"},[t._v("Выберите "+t._s(t.ttslogin.labelsInfo[s.id]))]),s.options.length&&!t.checkSelector(s)?i("span",{staticClass:"md-helper-text"},[t._v("Выберите "+t._s(t.ttslogin.labelsInfo[s.id]))]):t._e()],1)})),i("md-button",{directives:[{name:"show",rawName:"v-show",value:t.ttslogin.selectors.length,expression:"ttslogin.selectors.length"}],staticClass:"md-dense md-raised md-primary",attrs:{disabled:t.disabledInput},on:{click:t.checkTTS}},[t._v(t._s(t.ttslogin.loading?"Загрузка...":"Продолжить"))])],2),i("md-step",{attrs:{id:"auth","md-label":"Авторизация","md-error":t.auth.showError&&!1===t.auth.added?"Где-то ошибка":null,"md-description":t.auth.loading?"Проверка данных...":null}},[i("p",[t._v(" Ниже нужно ввести логин и пароль для входа в сетевой город. ")]),i("md-field",{class:{"md-invalid":t.auth.showError&&!1===t.auth.added&&t.auth.login==t.auth._login}},[i("label",[t._v("Логин")]),i("md-input",{attrs:{type:"text",autocomplete:"login",disabled:t.disabledInput},model:{value:t.auth.login,callback:function(s){t.$set(t.auth,"login",s)},expression:"auth.login"}}),t.auth.login?i("span",{staticClass:"md-error"},[t._v("Логин введен неверно")]):i("span",{staticClass:"md-error"},[t._v("Вы забыли ввести логин")]),i("span",{staticClass:"md-helper-text"},[t._v("Введите логин")])],1),i("md-field",{class:{"md-invalid":t.auth.showError&&!1===t.auth.added&&t.auth.password==t.auth._password}},[i("label",[t._v("Пароль")]),i("md-input",{attrs:{type:"password",autocomplete:"password",disabled:t.disabledInput},model:{value:t.auth.password,callback:function(s){t.$set(t.auth,"password",s)},expression:"auth.password"}}),t.auth.password?i("span",{staticClass:"md-error"},[t._v("Пароль введен неверно")]):i("span",{staticClass:"md-error"},[t._v("Вы забыли ввести пароль")]),i("span",{staticClass:"md-helper-text"},[t._v("Введите пароль")])],1),i("md-button",{staticClass:"md-dense md-raised md-primary",attrs:{disabled:t.disabledInput},on:{click:t.checkAuth}},[t._v(t._s("Войти"))])],1)],1)],1)},e=[],o=(i("99af"),i("7db0"),i("4160"),i("b0c0"),i("d3b7"),i("ac1f"),i("5319"),i("159b"),{data:function(){return{windowWidth:window.innerWidth,currentStep:"domain",domain:{host:"",fit:null,loading:!1},ttslogin:{done:!1,get tts(){var t="";return this.selectors.forEach((function(s){s.options.find((function(t){return t.id==s.value}))&&(t&&(t+="&"),t+="".concat(s.name,"=").concat(s.value))})),t},labels:{countries:"Страна",states:"Регион",provinces:"Округ/Район",cities:"Населённый пункт",funcs:"Тип ОО",schools:"Образовательная организация"},labelsInfo:{countries:"cтрану",states:"регион",provinces:"округ/район",cities:"населённый пункт",funcs:"тип ОО",schools:"образовательную организацию"},loading:!1,showError:!1,selectors:[]},auth:{loading:!1,login:"",_login:"",password:"",_password:"",added:null,showError:!1}}},computed:{disabledInput:function(){return this.domain.loading||this.ttslogin.loading||this.auth.loading},invalidTTSlogin:function(){return!(!this.ttslogin.showError||!this.ttslogin.selectors.find((function(t){return!t.options.find((function(s){return s.id==t.value}))})))}},methods:{onResize:function(){this.windowWidth=window.innerWidth},checkHost:function(){var t=this;this.domain.host&&(this.domain.fit=null,this.domain.loading=!0,this.domain.host=this.domain.host.replace(/https*:\/\/|\/.*/g,""),this.$store.dispatch("CheckHost",this.domain.host).then((function(s){t.domain.fit=s,s&&(t.loadForm(),t.currentStep="ttslogin")})).catch((function(s){return t.$root.$emit("catch-error",s)})).finally((function(){return t.domain.loading=!1})))},loadForm:function(){var t=this;this.ttslogin.loading=!0,this.$store.dispatch("GetAuthForm",this.domain.host).then((function(s){return t.ttslogin.selectors=s})).catch((function(s){return t.$root.$emit("catch-error",s)})).finally((function(){return t.ttslogin.loading=!1}))},checkSelector:function(t){return!!t.options.find((function(s){return s.id==t.value}))},loadItems:function(t){var s=this,i=this.ttslogin.selectors;if(!(t+1>=i.length)&&i[t].value){for(var n=t+1;n<i.length;n++)i[n].value=null,i[n].options=[];this.ttslogin.loading=!0,this.$store.dispatch("UploadAuthForm",{host:this.domain.host,allSelected:this.ttslogin.tts,lastSelected:i[t].name}).then((function(s){i[t+1].options=s,setTimeout((function(){1==s.length&&(i[t+1].value=s[0].id)}),0)})).catch((function(t){return s.$root.$emit("catch-error",t)})).finally((function(){return s.ttslogin.loading=!1}))}},checkTTS:function(){this.ttslogin.showError=!0,this.invalidTTSlogin||(this.currentStep="auth",this.ttslogin.done=!0,this.ttslogin.showError=!1)},checkAuth:function(){var t=this;if(this.auth.added=null,this.auth.showError=!0,this.auth._login=this.auth.login,this.auth._password=this.auth.password,!this.auth.login||!this.auth.password)return this.auth.added=!1;this.auth.loading=!0,this.$store.dispatch("AddNewUser",{host:this.domain.host,login:this.auth.login,password:this.auth.password,ttsLogin:this.ttslogin.tts}).then((function(s){t.auth.added=!0,t.$root.$emit("change-user",s),t.$store.state.settings.storage.connectedUsers.push(s),setTimeout((function(){return t.$router.replace("/diary")}),0)})).catch((function(s){if(4007==s.code)return t.auth.added=!1;t.$root.$emit("catch-error",s)})).finally((function(){return t.auth.loading=!1}))},hiddenSelector:function(t){var s,i,n,e,o,a,d=this.ttslogin.selectors;return t<0||t>=d.length||1==this.hiddenSelector(t-1)&&1==(null!==(s=null===(i=d[t])||void 0===i||null===(n=i.options)||void 0===n?void 0:n.length)&&void 0!==s?s:0)&&1==(null!==(e=null===(o=d[t+1])||void 0===o||null===(a=o.options)||void 0===a?void 0:a.length)&&void 0!==e?e:0)}},created:function(){window.addEventListener("resize",this.onResize)},destroyed:function(){window.removeEventListener("resize",this.onResize)}}),a=o,d=(i("d6db"),i("2877")),l=Object(d["a"])(a,n,e,!1,null,null,null);s["default"]=l.exports},d6db:function(t,s,i){"use strict";var n=i("e67a"),e=i.n(n);e.a},e67a:function(t,s,i){}}]);
//# sourceMappingURL=chunk-71367435.9508fd8c.js.map